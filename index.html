<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Tiffany Zeng" />

<meta name="date" content="2022-12-11" />

<title>bst260finalproject</title>

<script src="site_libs/header-attrs-2.16/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">BST 260 Final Project</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">BST 260 Final Project</a>
</li>
<li>
  <a href="tabs/tab1.html">References and Appendix</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">bst260finalproject</h1>
<h3 class="subtitle">Factors Associated with Healthcare Utilization
Among Elderly in Shanghai, China</h3>
<h4 class="author">Tiffany Zeng</h4>
<h4 class="date">2022-12-11</h4>

</div>


<div id="introduction" class="section level3">
<h3>Introduction</h3>
<p>China’s growing aging population can be seen as a threat to the
country’s healthcare system by pushing the government to shift their
resources to address the needs of the older population, therefore
putting more strain on the healthcare system. Although life expectancy
has increased by 17 years over the past 2 decades, the older population
experiences more years lived with disability due to chronic conditions
(Kennedy et al., 2014). The main challenge with a large elderly
population is that because almost 80% of deaths in China are attributed
to chronic NCDs among those aged 60 years and older, therefore it is
important to understand the factors that drive healthcare utilization
among China’s aging population.</p>
<p>According to the IHME, out of the top 10 causes of death for those
ages 70 and older, 9 are NCDs, with cardiovascular diseases, neoplasms,
and chronic respiratory diseases to be the top 3 causes of death (Vos et
al., 2020). Additionally, with the growing older population, China will
be losing 70 million of its workforce over the next few years, which
will be a huge shock to the global supply chain as much of the world
depends on China for its manufacturing factories.By ensuring a healthier
elderly population, more people would remain in the workforce and
therefore continue to contribute to China’s growing economy. There is a
saying that China will “get old before it gets rich,” which accurately
describes what the country is currently experiencing. A growing elderly
population coupled with a shrinking pool of working adults will add
pressure to the country’s health and social welfare system.</p>
<p>The objective of this study is to focus on the health status of
Shanghai’s aging population, as Shanghai has shown a more dramatic
growth in its aging population in recent years. According to the
Shanghai Bureau of Statistics, the city had a population of 14.5 million
people living in households by the end of 2016, of which over 31% were
aged 60 and over (Shanghai Bureau of Statistics, 2011).</p>
<p>The methodology of identifying this dataset was through
datasetsearch.research.google.com and entering keywords “healthcare
utilization among elderly population in China.” The dataset used in this
study is publicly available and sourced from a cross-sectional study
that developed a questionnaire used for face-to-face interviews
conducted in June and August 2011 among Shanghai’s 18 districts.</p>
</div>
<div id="results" class="section level3">
<h3>Results</h3>
<p>To begin the analysis, we are going to load the dataset:</p>
<div id="load-dataset" class="section level4">
<h4>Load Dataset</h4>
<pre class="r"><code>library(haven)
library(readxl)
library(tidyverse)</code></pre>
<pre><code>## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──
## ✔ ggplot2 3.3.6      ✔ purrr   0.3.4 
## ✔ tibble  3.1.8      ✔ dplyr   1.0.10
## ✔ tidyr   1.2.0      ✔ stringr 1.4.1 
## ✔ readr   2.1.2      ✔ forcats 0.5.2 
## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()</code></pre>
<pre class="r"><code>library(dplyr)
library(mlogit)</code></pre>
<pre><code>## Loading required package: dfidx
## 
## Attaching package: &#39;dfidx&#39;
## 
## The following object is masked from &#39;package:stats&#39;:
## 
##     filter</code></pre>
<pre class="r"><code>data &lt;- read_excel(&quot;elderly_china_data.xlsx&quot;)
head(data)</code></pre>
<pre><code>## # A tibble: 6 × 37
##   gender   age marry  race education children livingsta…¹ insur…² expen…³ income
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;       &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;
## 1     NA     2     3    NA         1        3           3       3       1      2
## 2      1     4     3     1         2        3           2       1       3      1
## 3      2     5     3     1         2        4           1       2       1      1
## 4      2     5     3     1         2        3           2       2       3      1
## 5      2     5     3     1         1        3           2       5       2      1
## 6      1     5     3     1         2        3           1       1       3      1
## # … with 27 more variables: location &lt;dbl&gt;, `self－rated health` &lt;dbl&gt;,
## #   `sensory limitation` &lt;dbl&gt;, lonely &lt;dbl&gt;, nervious &lt;dbl&gt;,
## #   `life feeling` &lt;dbl&gt;, ADL &lt;dbl&gt;, changing &lt;dbl&gt;, smoking &lt;dbl&gt;,
## #   drink &lt;dbl&gt;, hypertension &lt;dbl&gt;, Diabetes &lt;dbl&gt;, Heartdiseases &lt;dbl&gt;,
## #   Cerebrovascular &lt;dbl&gt;, Cataract &lt;dbl&gt;, Bronchitis &lt;dbl&gt;,
## #   Gastroenteritis &lt;dbl&gt;, Regionaleconomiclevel &lt;dbl&gt;, activity &lt;dbl&gt;,
## #   `Relatives gathering` &lt;dbl&gt;, community &lt;dbl&gt;, `Children meeting` &lt;dbl&gt;, …</code></pre>
<p>We see that some of the variables are either spelled or labeled
incorrectly, therefore we need to recode these variables before
beginning our analysis.</p>
</div>
<div id="rename-variables" class="section level4">
<h4>Rename Variables</h4>
<pre class="r"><code>colnames(data)[8] = &quot;insurance&quot;
colnames(data)[9] = &quot;pension_income&quot;
colnames(data)[10] = &quot;income_source&quot;
colnames(data)[15] = &quot;nervous&quot;
colnames(data)[16] = &quot;life_satisfaction&quot;
colnames(data)[18] = &quot;physical_health_change&quot;
colnames(data)[23] = &quot;Heart Disease&quot; 
colnames(data)[28] = &quot;regional_economic_level&quot;
colnames(data)[29] = &quot;outdoor_activity&quot;
colnames(data)[31] = &quot;community_activities&quot;
colnames(data)[32] = &quot;seeing_children&quot;
colnames(data)[36] = &quot;hospitalization&quot;
colnames(data)[37] = &quot;total_chronic&quot;</code></pre>
<p>We also want to double-check if there are any classification
discrepancies in the dataset as well as generate variables of interest
by converting them to binary variables if necessary. We are creating a
binary “chronic” variable to label those in our study population that
are diagnosed with 1 or more chronic conditions as “1” and those who do
not have chronic conditions as “0”. Additionally, we are creating a
“married” and “never_married” variable to further disaggregate the
“marry” variable. Lastly, we are generating a second gender and age
variable to easily identify their categories.</p>
</div>
<div id="convert-variable-typesgenerate-variables"
class="section level4">
<h4>Convert Variable Types/Generate Variables</h4>
<pre class="r"><code>class(data$gender)</code></pre>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<pre class="r"><code>data$gender2 &lt;- factor(ifelse(data$gender == 1, &quot;Male&quot;, &quot;Female&quot;))
data &lt;- data |&gt;
  mutate(age2 = factor (
    x = age,
    levels = 1:5,
    labels = c(&quot;60_64&quot;, &quot;65_69&quot;, &quot;70_74&quot;, &quot;75_79&quot;, &quot;&gt;=80&quot;
  )))

#generate binary chronic variable 
data$chronic &lt;- ifelse(data$total_chronic&gt;=1, 1, 0)

#generate indicator variables for married and never married
data$married &lt;- ifelse(data$marry == 3, 1, 0)
data$never_married &lt;- ifelse(data$marry == 1 &amp; 2, 1, 0)</code></pre>
</div>
<div id="summarize-variables" class="section level4">
<h4>Summarize Variables</h4>
<pre class="r"><code>data |&gt;
  group_by(gender) |&gt;
  summarize(n())</code></pre>
<pre><code>## # A tibble: 3 × 2
##   gender `n()`
##    &lt;dbl&gt; &lt;int&gt;
## 1      1   843
## 2      2  1154
## 3     NA     3</code></pre>
<pre class="r"><code>data |&gt;
  group_by(age) |&gt;
  summarize(n())</code></pre>
<pre><code>## # A tibble: 6 × 2
##     age `n()`
##   &lt;dbl&gt; &lt;int&gt;
## 1     1   643
## 2     2   339
## 3     3   314
## 4     4   378
## 5     5   325
## 6    NA     1</code></pre>
<pre class="r"><code>data |&gt;
  group_by(race) |&gt;
  summarize(n())</code></pre>
<pre><code>## # A tibble: 3 × 2
##    race `n()`
##   &lt;dbl&gt; &lt;int&gt;
## 1     1  1975
## 2     2    21
## 3    NA     4</code></pre>
<pre class="r"><code>data |&gt;
  group_by(education) |&gt;
  summarize(n())</code></pre>
<pre><code>## # A tibble: 5 × 2
##   education `n()`
##       &lt;dbl&gt; &lt;int&gt;
## 1         1   572
## 2         2   636
## 3         3   672
## 4         4   114
## 5        NA     6</code></pre>
<pre class="r"><code>data |&gt;
  group_by(children) |&gt;
  summarize(n())</code></pre>
<pre><code>## # A tibble: 5 × 2
##   children `n()`
##      &lt;dbl&gt; &lt;int&gt;
## 1        1    26
## 2        2  1057
## 3        3   758
## 4        4   148
## 5       NA    11</code></pre>
<p>Lastly, summarizing variables of interest gives us a better
understanding of the percentage breakdown within each category.
Extensive data wrangling was necessary for this dataset since we wanted
to manipulate variables that are specific to this analysis. The original
dataset had many errors that would not have allowed for appropriate
analyses.</p>
</div>
<div id="linear-regression" class="section level4">
<h4>Linear Regression</h4>
<pre class="r"><code>m1 &lt;- lm(chronic ~ gender + age + married + never_married + race + education + children + livingstatus + insurance + pension_income + location + lonely + smoking + drink, 
         data=data)

summary(m1)</code></pre>
<pre><code>## 
## Call:
## lm(formula = chronic ~ gender + age + married + never_married + 
##     race + education + children + livingstatus + insurance + 
##     pension_income + location + lonely + smoking + drink, data = data)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.01185  0.06804  0.20046  0.25588  0.40154 
## 
## Coefficients:
##                 Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)     0.496439   0.150736   3.293  0.00101 ** 
## gender          0.013107   0.024853   0.527  0.59799    
## age             0.018514   0.008686   2.132  0.03318 *  
## married         0.066425   0.060941   1.090  0.27586    
## never_married   0.041467   0.064320   0.645  0.51920    
## race            0.078767   0.090766   0.868  0.38561    
## education      -0.005181   0.013440  -0.386  0.69990    
## children        0.019607   0.018503   1.060  0.28944    
## livingstatus    0.017559   0.014157   1.240  0.21503    
## insurance      -0.021157   0.009197  -2.300  0.02153 *  
## pension_income -0.008260   0.015810  -0.522  0.60142    
## location       -0.029241   0.016897  -1.731  0.08370 .  
## lonely          0.089905   0.020301   4.429    1e-05 ***
## smoking        -0.012913   0.013576  -0.951  0.34165    
## drink           0.011095   0.012049   0.921  0.35726    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.412 on 1896 degrees of freedom
##   (89 observations deleted due to missingness)
## Multiple R-squared:  0.02773,    Adjusted R-squared:  0.02055 
## F-statistic: 3.862 on 14 and 1896 DF,  p-value: 1.573e-06</code></pre>
<p>The first model we are interested in building is a simple linear
regression. We see that the “location” variable is significant at the
0.1 level, the “age” and “insurance” variables are significant at the
0.05 level, and the “lonely” variable is significant at the 0.0001
level.</p>
</div>
<div id="logistic-regression" class="section level4">
<h4>Logistic Regression</h4>
<pre class="r"><code>m2 &lt;- glm(chronic ~ gender + age + married + never_married + race + education + children + livingstatus + insurance + pension_income + location + lonely + smoking + drink, 
          family = binomial(link = &quot;logit&quot;),
               data = data)

summary(m2)</code></pre>
<pre><code>## 
## Call:
## glm(formula = chronic ~ gender + age + married + never_married + 
##     race + education + children + livingstatus + insurance + 
##     pension_income + location + lonely + smoking + drink, family = binomial(link = &quot;logit&quot;), 
##     data = data)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.4730   0.4079   0.6579   0.7651   1.0905  
## 
## Coefficients:
##                Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)    -0.64828    0.94051  -0.689   0.4906    
## gender          0.07363    0.14536   0.507   0.6125    
## age             0.11073    0.05203   2.128   0.0333 *  
## married         0.39468    0.34016   1.160   0.2459    
## never_married   0.24415    0.36460   0.670   0.5031    
## race            0.51243    0.63168   0.811   0.4172    
## education      -0.03171    0.08036  -0.395   0.6932    
## children        0.12752    0.11311   1.127   0.2596    
## livingstatus    0.10114    0.08372   1.208   0.2271    
## insurance      -0.12381    0.05270  -2.349   0.0188 *  
## pension_income -0.04056    0.09284  -0.437   0.6622    
## location       -0.16845    0.09759  -1.726   0.0843 .  
## lonely          0.70438    0.15854   4.443 8.87e-06 ***
## smoking        -0.07641    0.07915  -0.965   0.3343    
## drink           0.06400    0.07055   0.907   0.3643    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 2027.9  on 1910  degrees of freedom
## Residual deviance: 1969.5  on 1896  degrees of freedom
##   (89 observations deleted due to missingness)
## AIC: 1999.5
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<p>Because a simple linear regression is oftentimes not a feasible
method to measure the effects of different factors on chronic health
outcomes, a better method would be a logistic regression. In this
analysis, we also see that the “location” variable is significant at the
0.1 level, the “age” and “insurance” variables are significant at the
0.05 level, and the “lonely” variable is significant at the 0.0001
level.</p>
</div>
<div id="poisson-test" class="section level4">
<h4>Poisson Test</h4>
<pre class="r"><code>m3 &lt;- glm(chronic ~ gender + age + married + never_married + race + education + children + livingstatus + insurance + pension_income + location + lonely + smoking + drink, 
          family = &quot;poisson&quot;,
               data = data)

summary(m3)</code></pre>
<pre><code>## 
## Call:
## glm(formula = chronic ~ gender + age + married + never_married + 
##     race + education + children + livingstatus + insurance + 
##     pension_income + location + lonely + smoking + drink, family = &quot;poisson&quot;, 
##     data = data)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -1.43653   0.06638   0.21825   0.28265   0.44858  
## 
## Coefficients:
##                 Estimate Std. Error z value Pr(&gt;|z|)  
## (Intercept)    -0.601653   0.411906  -1.461   0.1441  
## gender          0.017230   0.068772   0.251   0.8022  
## age             0.023786   0.023845   0.998   0.3185  
## married         0.086344   0.172914   0.499   0.6175  
## never_married   0.054415   0.181461   0.300   0.7643  
## race            0.098419   0.238166   0.413   0.6794  
## education      -0.006587   0.036868  -0.179   0.8582  
## children        0.024427   0.050398   0.485   0.6279  
## livingstatus    0.022784   0.039014   0.584   0.5592  
## insurance      -0.027452   0.025751  -1.066   0.2864  
## pension_income -0.011362   0.043697  -0.260   0.7948  
## location       -0.038075   0.047054  -0.809   0.4184  
## lonely          0.107386   0.052609   2.041   0.0412 *
## smoking        -0.016670   0.037672  -0.443   0.6581  
## drink           0.014429   0.033335   0.433   0.6651  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 749.07  on 1910  degrees of freedom
## Residual deviance: 737.53  on 1896  degrees of freedom
##   (89 observations deleted due to missingness)
## AIC: 3737.5
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<pre class="r"><code>library(mfx)</code></pre>
<pre><code>## Loading required package: sandwich</code></pre>
<pre><code>## Loading required package: lmtest</code></pre>
<pre><code>## Loading required package: zoo</code></pre>
<pre><code>## 
## Attaching package: &#39;zoo&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     as.Date, as.Date.numeric</code></pre>
<pre><code>## Loading required package: MASS</code></pre>
<pre><code>## 
## Attaching package: &#39;MASS&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:dfidx&#39;:
## 
##     select</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     select</code></pre>
<pre><code>## Loading required package: betareg</code></pre>
<pre class="r"><code>library(sandwich)
library(lmtest)
library(zoo)

poissonmfx(formula = chronic ~ gender + age + married + never_married + race + education + children + livingstatus + insurance + pension_income + location + lonely + smoking + drink, 
           data=data)</code></pre>
<pre><code>## Call:
## poissonmfx(formula = chronic ~ gender + age + married + never_married + 
##     race + education + children + livingstatus + insurance + 
##     pension_income + location + lonely + smoking + drink, data = data)
## 
## Marginal Effects:
##                     dF/dx  Std. Err.       z   P&gt;|z|  
## gender          0.0133212  0.0531017  0.2509 0.80192  
## age             0.0184138  0.0184530  0.9979 0.31834  
## married         0.0653462  0.1279337  0.5108 0.60950  
## never_married   0.0428012  0.1450204  0.2951 0.76789  
## race            0.0799781  0.2030002  0.3940 0.69360  
## education      -0.0050989  0.0285405 -0.1787 0.85821  
## children        0.0189099  0.0390118  0.4847 0.62787  
## livingstatus    0.0176376  0.0301981  0.5841 0.55918  
## insurance      -0.0212518  0.0199268 -1.0665 0.28620  
## pension_income -0.0087960  0.0338264 -0.2600 0.79484  
## location       -0.0294749  0.0364181 -0.8093 0.41831  
## lonely          0.0831310  0.0406777  2.0436 0.04099 *
## smoking        -0.0129048  0.0291611 -0.4425 0.65810  
## drink           0.0111696  0.0258039  0.4329 0.66511  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## dF/dx is for discrete change for the following variables:
## 
## [1] &quot;gender&quot;        &quot;married&quot;       &quot;never_married&quot; &quot;race&quot;</code></pre>
<p>Although a Poisson model would not be too informative for this
analysis, I wanted to explore whether the “lonely” variable was still
significant in this context, which it is.</p>
</div>
<div id="chi-squared-test" class="section level4">
<h4>Chi-squared Test</h4>
<pre class="r"><code>chisq &lt;- chisq.test(data$chronic, data$lonely)
chisq</code></pre>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  data$chronic and data$lonely
## X-squared = 24.348, df = 2, p-value = 5.164e-06</code></pre>
<p>Because the “lonely” variable has consistently shown to be
significant, I wanted to do a chi-squared test between “chronic” and
“lonely” to validate that an elderly person experiencing loneliness is a
significant indicator to whether they are diagnosed by chronic
conditions. Because p &lt; 0.05, it is in fact significant.</p>
</div>
</div>
<div id="conclusion" class="section level3">
<h3>Conclusion</h3>
<p>The research question of this study is to explore the effect of
different factors on developing chronic conditions among the elderly
population in China. The results showed the impact of economic status,
health status, demographic and social characteristics on developing
chronic conditions. The most surprising finding was that loneliness was
a significant indicator of whether an elderly person develops chronic
conditions, pointing towards the shift in Chinese culture where
traditionally, children would eventually become the main caretakers of
their parents. However, the Only-Child Policy in China has impacted this
tradition as parents increasingly encourage their children to pursue
their careers and not worry about their health, causing many children to
not return to their families as often as they would if each family was
still able to raise more children. This policy has proven to be
devastating and burdening on China’s health system as doctors are pushed
to see more patients.</p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
